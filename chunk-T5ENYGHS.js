import{a as k}from"./chunk-ETPNZVP7.js";import{$ as M,A as o,Aa as D,D as v,E as C,I as m,Ja as I,Q as s,R as a,S as n,T as b,Z as P,a as f,b as u,ba as d,ea as r,fa as l,ga as p,na as O,oa as y,pa as E,q as _,r as x,wa as h,xa as F,ya as w,za as S}from"./chunk-NBSBNSKY.js";var $=t=>["/facturas",t];function L(t,i){t&1&&(a(0,"div",6),b(1,"div",7),a(2,"p"),r(3,"Cargando facturas..."),n()())}function N(t,i){if(t&1&&(a(0,"div",8),r(1),n()),t&2){let e=d();o(),p(" \u26A0\uFE0F ",e.error," ")}}function R(t,i){if(t&1&&(a(0,"div",19)(1,"span",15),r(2,"Reserva:"),n(),a(3,"span",20),r(4),n()()),t&2){let e=d().$implicit;o(4),l(e.reserva.codigoReserva||"N/A")}}function j(t,i){if(t&1&&(a(0,"div",19)(1,"span",15),r(2,"\u{1F4B0} M\xE9todo de Pago:"),n(),a(3,"span",20),r(4),y(5,"titlecase"),n()()),t&2){let e=d().$implicit;o(4),l(E(5,1,e.metodoPago))}}function V(t,i){if(t&1&&(a(0,"div",23)(1,"span",31),r(2,"Descuento Cliente Frecuente:"),n(),a(3,"span",31),r(4),n()()),t&2){let e=d().$implicit,c=d(2);o(4),p("-",c.formatearMoneda(e.descuentos.clienteFrecuente))}}function U(t,i){if(t&1&&(a(0,"div",23)(1,"span"),r(2,"IVA (12%):"),n(),a(3,"span"),r(4),n()()),t&2){let e=d().$implicit,c=d(2);o(4),l(c.formatearMoneda(e.iva))}}function A(t,i){if(t&1&&(a(0,"div",32)(1,"span",32),r(2,"Recargo Feriado:"),n(),a(3,"span",32),r(4),n()()),t&2){let e=d().$implicit,c=d(2);o(4),p("+",c.formatearMoneda(e.recargos.feriado))}}function B(t,i){if(t&1&&(a(0,"div",23)(1,"span",33),r(2,"Da\xF1os:"),n(),a(3,"span",33),r(4),n()()),t&2){let e=d().$implicit,c=d(2);o(4),p("+",c.formatearMoneda(e.totalDanos))}}function H(t,i){if(t&1&&(a(0,"div",34)(1,"strong"),r(2,"\u{1F4DD} Observaciones:"),n(),a(3,"p"),r(4),n()()),t&2){let e=d().$implicit;o(4),l(e.observaciones)}}function Y(t,i){if(t&1){let e=P();a(0,"div",12)(1,"div",13)(2,"div",14)(3,"span",15),r(4,"\u{1F4C4} Factura"),n(),a(5,"span",16),r(6),n()(),a(7,"span",17),r(8),n()(),a(9,"div",18)(10,"div",19)(11,"span",15),r(12,"\u{1F4C5} Fecha de Emisi\xF3n:"),n(),a(13,"span",20),r(14),n()(),m(15,R,5,1,"div",21)(16,j,6,3,"div",21),n(),a(17,"div",22)(18,"div",23)(19,"span"),r(20,"Subtotal:"),n(),a(21,"span"),r(22),n()(),m(23,V,5,1,"div",24)(24,U,5,1,"div",24)(25,A,5,1,"div",25)(26,B,5,1,"div",24),a(27,"div",26)(28,"span"),r(29,"Total:"),n(),a(30,"span"),r(31),n()()(),a(32,"div",27)(33,"button",28),M("click",function(){let g=_(e).$implicit,z=d(2);return x(z.descargarPDF(g.id))}),r(34," \u{1F4E5} Descargar PDF "),n(),a(35,"a",29),r(36," Ver Detalles "),n()(),m(37,H,5,1,"div",30),n()}if(t&2){let e=i.$implicit,c=d(2);o(6),l(e.numeroFactura),o(),s("ngClass",c.getEstadoClass(e.estadoPago)),o(),p(" ",c.getEstadoTexto(e.estadoPago)," "),o(6),l(c.formatearFecha(e.fechaEmision)),o(),s("ngIf",e.reserva&&typeof e.reserva=="object"),o(),s("ngIf",e.metodoPago),o(6),l(c.formatearMoneda(e.subtotal)),o(),s("ngIf",e.descuentos&&e.descuentos.clienteFrecuente>0),o(),s("ngIf",e.iva>0),o(),s("ngIf",e.recargos&&e.recargos.feriado>0),o(),s("ngIf",e.totalDanos>0),o(5),l(c.formatearMoneda(e.total)),o(4),s("routerLink",O(14,$,e.id)),o(2),s("ngIf",e.observaciones)}}function q(t,i){t&1&&(a(0,"div",35)(1,"span",36),r(2,"\u{1F4C4}"),n(),a(3,"h3"),r(4,"No tienes facturas"),n(),a(5,"p"),r(6,"Cuando completes una reserva, se generar\xE1 una factura autom\xE1ticamente"),n(),a(7,"a",37),r(8,"Ver Habitaciones"),n()())}function G(t,i){if(t&1&&(a(0,"div",9),m(1,Y,38,16,"div",10)(2,q,9,0,"div",11),n()),t&2){let e=d();o(),s("ngForOf",e.facturas),o(),s("ngIf",e.facturas.length===0)}}var T=class t{constructor(i){this.facturaService=i}facturas=[];cargando=!0;error="";ngOnInit(){this.cargarFacturas()}cargarFacturas(){this.facturaService.obtenerFacturas().subscribe({next:i=>{i.success&&i.data&&(this.facturas=i.data.map(e=>u(f({},e),{id:e.id||e._id}))),this.cargando=!1},error:i=>{console.error("\u274C Error al cargar facturas:",i),this.error="Error al cargar facturas",this.cargando=!1}})}descargarPDF(i){this.facturaService.descargarFacturaPDF(i).subscribe({next:e=>{let c=window.URL.createObjectURL(e),g=document.createElement("a");g.href=c,g.download=`factura-${i}.pdf`,g.click(),window.URL.revokeObjectURL(c)},error:e=>{console.error("Error al descargar PDF:",e),alert("Error al descargar la factura en PDF")}})}formatearMoneda(i){return new Intl.NumberFormat("es-EC",{style:"currency",currency:"USD"}).format(i)}formatearFecha(i){return new Date(i).toLocaleDateString("es-EC",{year:"numeric",month:"long",day:"numeric"})}getEstadoClass(i){return{pagada:"estado-pagada",pendiente:"estado-pendiente",parcial:"estado-parcial",anulada:"estado-anulada"}[i]||""}getEstadoTexto(i){return{pagada:"Pagada",pendiente:"Pendiente",parcial:"Pago Parcial",anulada:"Anulada"}[i]||i}static \u0275fac=function(e){return new(e||t)(v(k))};static \u0275cmp=C({type:t,selectors:[["app-facturas"]],decls:9,vars:3,consts:[[1,"facturas-container"],[1,"header"],[1,"subtitle"],["class","loading",4,"ngIf"],["class","alert alert-error",4,"ngIf"],["class","facturas-grid",4,"ngIf"],[1,"loading"],[1,"spinner"],[1,"alert","alert-error"],[1,"facturas-grid"],["class","factura-card",4,"ngFor","ngForOf"],["class","empty-state",4,"ngIf"],[1,"factura-card"],[1,"factura-header"],[1,"factura-numero"],[1,"label"],[1,"numero"],[1,"estado-badge",3,"ngClass"],[1,"factura-info"],[1,"info-row"],[1,"value"],["class","info-row",4,"ngIf"],[1,"factura-detalles"],[1,"detalle-row"],["class","detalle-row",4,"ngIf"],["class","recargo",4,"ngIf"],[1,"detalle-row","total"],[1,"factura-actions"],[1,"btn","btn-primary",3,"click"],[1,"btn","btn-secondary",3,"routerLink"],["class","observaciones",4,"ngIf"],[1,"descuento"],[1,"recargo"],[1,"dano"],[1,"observaciones"],[1,"empty-state"],[1,"empty-icon"],["routerLink","/departamentos",1,"btn","btn-primary"]],template:function(e,c){e&1&&(a(0,"div",0)(1,"div",1)(2,"h1"),r(3," Mis Facturas"),n(),a(4,"p",2),r(5,"Historial de facturas y pagos"),n()(),m(6,L,4,0,"div",3)(7,N,2,1,"div",4)(8,G,3,2,"div",5),n()),e&2&&(o(6),s("ngIf",c.cargando),o(),s("ngIf",c.error&&!c.cargando),o(),s("ngIf",!c.cargando&&!c.error))},dependencies:[D,h,F,w,I,S],styles:[".facturas-container[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto;padding:2rem}.header[_ngcontent-%COMP%]{text-align:center;margin-bottom:3rem;padding:2rem;background:linear-gradient(135deg,#1b5e20,#2e7d32);color:#fff;border-radius:15px;box-shadow:0 4px 20px #1b5e204d}.header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:2.5rem;margin:0 0 .5rem;font-weight:700}.subtitle[_ngcontent-%COMP%]{font-size:1.1rem;margin:0;opacity:.95}.loading[_ngcontent-%COMP%]{text-align:center;padding:3rem}.spinner[_ngcontent-%COMP%]{width:50px;height:50px;border:4px solid #e0e0e0;border-top-color:#2e7d32;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite;margin:0 auto 1rem}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.alert[_ngcontent-%COMP%]{padding:1rem;border-radius:8px;margin-bottom:2rem}.alert-error[_ngcontent-%COMP%]{background-color:#ffebee;color:#c62828;border:1px solid #ef5350}.facturas-grid[_ngcontent-%COMP%]{display:grid;gap:2rem}.factura-card[_ngcontent-%COMP%]{background:#fff;border-radius:15px;padding:2rem;box-shadow:0 4px 15px #0000001a;transition:transform .3s ease,box-shadow .3s ease}.factura-card[_ngcontent-%COMP%]:hover{transform:translateY(-5px);box-shadow:0 8px 25px #00000026}.factura-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1.5rem;padding-bottom:1rem;border-bottom:2px solid #f5f5f5}.factura-numero[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.3rem}.factura-numero[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-size:.85rem;color:#666;font-weight:500}.factura-numero[_ngcontent-%COMP%]   .numero[_ngcontent-%COMP%]{font-size:1.3rem;font-weight:700;color:#1b5e20}.estado-badge[_ngcontent-%COMP%]{padding:.5rem 1rem;border-radius:25px;font-size:.85rem;font-weight:600;text-transform:uppercase;letter-spacing:.5px}.estado-pagada[_ngcontent-%COMP%]{background-color:#e8f5e9;color:#2e7d32}.estado-pendiente[_ngcontent-%COMP%]{background-color:#fff3e0;color:#f57c00}.estado-parcial[_ngcontent-%COMP%]{background-color:#e3f2fd;color:#1976d2}.estado-anulada[_ngcontent-%COMP%]{background-color:#ffebee;color:#c62828}.factura-info[_ngcontent-%COMP%]{margin-bottom:1.5rem}.info-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:.75rem 0;border-bottom:1px solid #f5f5f5}.info-row[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{color:#666;font-weight:500}.info-row[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{color:#333;font-weight:600}.factura-detalles[_ngcontent-%COMP%]{background-color:#f9f9f9;border-radius:10px;padding:1.5rem;margin:1.5rem 0}.detalle-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:.5rem 0;font-size:.95rem}.detalle-row.total[_ngcontent-%COMP%]{border-top:2px solid #2e7d32;margin-top:.75rem;padding-top:.75rem;font-size:1.2rem;font-weight:700;color:#1b5e20}.descuento[_ngcontent-%COMP%]{color:#2e7d32;font-weight:600}.recargo[_ngcontent-%COMP%]{color:#f57c00;font-weight:600}.dano[_ngcontent-%COMP%]{color:#c62828;font-weight:600}.factura-actions[_ngcontent-%COMP%]{display:flex;gap:1rem;margin-top:1.5rem}.btn[_ngcontent-%COMP%]{flex:1;padding:.875rem 1.5rem;border:none;border-radius:8px;font-size:1rem;font-weight:600;cursor:pointer;transition:all .3s ease;text-align:center;text-decoration:none;display:inline-block}.btn-primary[_ngcontent-%COMP%]{background:linear-gradient(135deg,#2e7d32,#1b5e20);color:#fff}.btn-primary[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#1b5e20,#0d3d10);transform:translateY(-2px);box-shadow:0 4px 15px #1b5e204d}.btn-secondary[_ngcontent-%COMP%]{background:#fff;color:#2e7d32;border:2px solid #2e7d32}.btn-secondary[_ngcontent-%COMP%]:hover{background:#2e7d32;color:#fff}.observaciones[_ngcontent-%COMP%]{margin-top:1.5rem;padding:1rem;background-color:#f5f5f5;border-radius:8px;border-left:4px solid #2e7d32}.observaciones[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{display:block;margin-bottom:.5rem;color:#1b5e20}.observaciones[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#666;line-height:1.6}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:4rem 2rem;background:#fff;border-radius:15px;box-shadow:0 4px 15px #0000001a}.empty-icon[_ngcontent-%COMP%]{font-size:5rem;display:block;margin-bottom:1rem;opacity:.5}.empty-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#333;font-size:1.5rem;margin-bottom:.5rem}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#666;margin-bottom:2rem}@media (max-width: 768px){.facturas-container[_ngcontent-%COMP%]{padding:1rem}.header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.8rem}.factura-card[_ngcontent-%COMP%]{padding:1.5rem}.factura-actions[_ngcontent-%COMP%]{flex-direction:column}.factura-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:1rem}}"]})};export{T as FacturasComponent};
