<div class="facturas-container">
  <div class="header">
    <h1> Mis Facturas</h1>
    <p class="subtitle">Historial de facturas y pagos</p>
  </div>

  <!-- Loading -->
  <div class="loading" *ngIf="cargando">
    <div class="spinner"></div>
    <p>Cargando facturas...</p>
  </div>

  <!-- Error -->
  <div class="alert alert-error" *ngIf="error && !cargando">
    âš ï¸ {{ error }}
  </div>

  <!-- Lista de Facturas -->
  <div class="facturas-grid" *ngIf="!cargando && !error">
    <div class="factura-card" *ngFor="let factura of facturas">
      <div class="factura-header">
        <div class="factura-numero">
          <span class="label">ğŸ“„ Factura</span>
          <span class="numero">{{ factura.numeroFactura }}</span>
        </div>
        <span class="estado-badge" [ngClass]="getEstadoClass(factura.estadoPago)">
          {{ getEstadoTexto(factura.estadoPago) }}
        </span>
      </div>

      <div class="factura-info">
        <div class="info-row">
          <span class="label">ğŸ“… Fecha de EmisiÃ³n:</span>
          <span class="value">{{ formatearFecha(factura.fechaEmision) }}</span>
        </div>

        <div class="info-row" *ngIf="factura.reserva && typeof factura.reserva === 'object'">
          <span class="label">Reserva:</span>
          <span class="value">{{ factura.reserva.codigoReserva || 'N/A' }}</span>
        </div>

        <div class="info-row" *ngIf="factura.metodoPago">
          <span class="label">ğŸ’° MÃ©todo de Pago:</span>
          <span class="value">{{ factura.metodoPago | titlecase }}</span>
        </div>
      </div>

      <div class="factura-detalles">
        <div class="detalle-row">
          <span>Subtotal:</span>
          <span>{{ formatearMoneda(factura.subtotal) }}</span>
        </div>

        <div class="detalle-row" *ngIf="factura.descuentos && factura.descuentos.clienteFrecuente > 0">
          <span class="descuento">Descuento Cliente Frecuente:</span>
          <span class="descuento">-{{ formatearMoneda(factura.descuentos.clienteFrecuente) }}</span>
        </div>

        <div class="detalle-row" *ngIf="factura.iva > 0">
          <span>IVA (12%):</span>
          <span>{{ formatearMoneda(factura.iva) }}</span>
        </div>

        <div class="detalle-row" *ngIf="factura.recargos && factura.recargos.feriado > 0" class="recargo">
          <span class="recargo">Recargo Feriado:</span>
          <span class="recargo">+{{ formatearMoneda(factura.recargos.feriado) }}</span>
        </div>

        <div class="detalle-row" *ngIf="factura.totalDanos > 0">
          <span class="dano">DaÃ±os:</span>
          <span class="dano">+{{ formatearMoneda(factura.totalDanos) }}</span>
        </div>

        <div class="detalle-row total">
          <span>Total:</span>
          <span>{{ formatearMoneda(factura.total) }}</span>
        </div>
      </div>

      <div class="factura-actions">
        <button class="btn btn-primary" (click)="descargarPDF(factura.id)">
          ğŸ“¥ Descargar PDF
        </button>
        <a [routerLink]="['/facturas', factura.id]" class="btn btn-secondary">
          Ver Detalles
        </a>
      </div>

      <div class="observaciones" *ngIf="factura.observaciones">
        <strong>ğŸ“ Observaciones:</strong>
        <p>{{ factura.observaciones }}</p>
      </div>
    </div>

    <!-- Empty State -->
    <div class="empty-state" *ngIf="facturas.length === 0">
      <span class="empty-icon">ğŸ“„</span>
      <h3>No tienes facturas</h3>
      <p>Cuando completes una reserva, se generarÃ¡ una factura automÃ¡ticamente</p>
      <a routerLink="/departamentos" class="btn btn-primary">Ver Habitaciones</a>
    </div>
  </div>
</div>
